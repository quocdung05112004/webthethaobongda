DROP DATABASE IF EXISTS quanlydothethao;
CREATE DATABASE quanlydothethao;
USE quanlydothethao;

SET FOREIGN_KEY_CHECKS = 0;


-- Bảng người dùng
CREATE TABLE nguoi_dung (
    id INT AUTO_INCREMENT PRIMARY KEY,
    ho_ten VARCHAR(100),
    email VARCHAR(150) UNIQUE,
    mat_khau VARCHAR(255),
    so_dien_thoai VARCHAR(20),
    dia_chi VARCHAR(255),
    vai_tro TINYINT DEFAULT 0,  -- 0: khách, 1: admin
    ngay_tao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Bảng danh mục sản phẩm
CREATE TABLE danh_muc (
    id INT AUTO_INCREMENT PRIMARY KEY,
    ten VARCHAR(100) NOT NULL,
    mo_ta TEXT,
    ngay_tao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Bảng sản phẩm
CREATE TABLE san_pham (
    id INT AUTO_INCREMENT PRIMARY KEY,
    ten VARCHAR(150) NOT NULL,
    danh_muc_id INT,
    gia DECIMAL(12,2) NOT NULL DEFAULT 0,
    mo_ta TEXT,
    hinh_anh VARCHAR(200),
    ngay_tao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (danh_muc_id) REFERENCES danh_muc(id)
);

-- Giỏ hàng
CREATE TABLE gio_hang (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nguoi_dung_id INT,
    san_pham_id INT,
    so_luong INT DEFAULT 1,
    ngay_them TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (nguoi_dung_id) REFERENCES nguoi_dung(id),
    FOREIGN KEY (san_pham_id) REFERENCES san_pham(id)
);

-- Đơn hàng
CREATE TABLE don_hang (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nguoi_dung_id INT,
    tong_tien DECIMAL(12,2),
    trang_thai VARCHAR(50) DEFAULT 'Chờ xử lý',
    ngay_dat TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (nguoi_dung_id) REFERENCES nguoi_dung(id)
);

-- Chi tiết đơn hàng
CREATE TABLE don_hang_chi_tiet (
    id INT AUTO_INCREMENT PRIMARY KEY,
    don_hang_id INT,
    san_pham_id INT,
    so_luong INT,
    gia DECIMAL(12,2),
    thanh_tien DECIMAL(12,2),
    FOREIGN KEY (don_hang_id) REFERENCES don_hang(id),
    FOREIGN KEY (san_pham_id) REFERENCES san_pham(id)
);



-- dữ liệu mẫu: danh mục
INSERT INTO danh_muc (ten, mo_ta)
VALUES
('Giày thể thao', 'Các loại giày chạy, giày bóng đá, giày gym'),
('Quần áo thể thao', 'Áo, quần thể thao nam nữ'),
('Phụ kiện thể thao', 'Balo, bình nước, tất, băng quấn'),
('Dụng cụ thể thao', 'Dụng cụ tập gym, bóng, dây nhảy');

-- dữ liệu mẫu: sản phẩm
INSERT INTO san_pham (ten, danh_muc_id, gia, mo_ta, hinh_anh)
VALUES
('Giày Nike Air Zoom Pegasus', 1, 2390000, 'Giày chạy bộ cao cấp Nike', 'giay_pegasus.jpg'),
('Giày Adidas Predator', 1, 1890000, 'Giày bóng đá Adidas chính hãng', 'predator.jpg'),
('Áo bóng đá Real Madrid 2024', 2, 499000, 'Áo đấu sân nhà RM 2024', 'real_2024.jpg'),
('Quần thể thao Nike Dri-FIT', 2, 350000, 'Quần thể thao thoáng khí', 'quannike.jpg'),
('Balo thể thao Adidas', 3, 690000, 'Balo thời trang thể thao', 'balo_adidas.jpg'),
('Bình nước sports 750ml', 3, 120000, 'Bình nước chất liệu an toàn', 'binhnuoc.jpg'),
('Bóng đá Molten F5', 4, 550000, 'Bóng đá size 5 chất lượng cao', 'bong_molten.jpg');

-- dữ liệu mẫu: giỏ hàng
INSERT INTO gio_hang (nguoi_dung_id, san_pham_id, so_luong)
VALUES
(1, 1, 1),
(1, 3, 2),
(2, 5, 1);

-- dữ liệu mẫu: đơn hàng
INSERT INTO don_hang (nguoi_dung_id, tong_tien, trang_thai)
VALUES
(1, 3380000, 'Chờ xử lý'),
(2, 690000, 'Hoàn thành');

-- dữ liệu mẫu: chi tiết đơn hàng
INSERT INTO don_hang_chi_tiet (don_hang_id, san_pham_id, so_luong, gia, thanh_tien)
VALUES
(1, 1, 1, 2390000, 2390000),
(1, 3, 2, 499000, 998000),
(2, 5, 1, 690000, 690000);

SET FOREIGN_KEY_CHECKS = 1;

